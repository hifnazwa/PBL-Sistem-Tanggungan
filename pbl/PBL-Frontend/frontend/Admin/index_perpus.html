<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Perpustakaan</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: "Open Sans", sans-serif;
      color: #333;
      background-color: #f9f9f9;
      margin: 0;
      display: flex;
    }

    .sidebar {
      width: 250px;
      background-color: #231a6f;
      color: #fff;
      min-height: 100vh;
      padding: 20px;
      position: fixed;
    }

    .sidebar h2 {
      font-size: 22px;
      margin-bottom: 20px;
      text-align: center;
      font-weight: bold;
    }

    .sidebar ul {
      list-style: none;
      padding: 0;
    }

    .sidebar ul li {
      margin: 10px 0;
    }

    .sidebar ul li a {
      color: #fff;
      text-decoration: none;
      padding: 10px;
      display: block;
      border-radius: 5px;
      transition: background 0.3s;
    }

    .sidebar ul li a:hover {
      background-color: #374085;
    }

    .content {
      margin-left: 270px;
      padding: 30px;
      width: 100%;
    }

    .table-container {
      margin-top: 20px;
    }

    .form-container {
      margin-top: 30px;
      padding: 20px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>
<body>

  <!-- Sidebar -->
  <div class="sidebar">
    <h2>Admin Perpustakaan</h2>
    <ul>
      <li><a href="javascript:void(0)" onclick="showBooks()">Daftar Buku</a></li>
      <li><a href="javascript:void(0)" onclick="showAddBorrower()">Input Data Peminjam</a></li>
      <li><a href="javascript:void(0)" onclick="showBorrowingList()">List Peminjaman</a></li>
    </ul>
  </div>

<!-- Daftar Buku -->
<section class="content" id="books-content">
    <h1>Daftar Buku</h1>
    <div class="table-container">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>#</th>
            <th>Judul Buku</th>
            <th>Penulis</th>
            <th>Status</th>
            <th>Tanggal Pinjam</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>Dasar Pemrograman</td>
            <td>John Doe</td>
            <td class="text-success">Tersedia</td>
            <td>-</td>
          </tr>
          <tr>
            <td>2</td>
            <td>Basis Data</td>
            <td>Jane Smith</td>
            <td class="text-danger">Dipinjam</td>
            <td>2024-12-01</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>
  

  <!-- Input Data Peminjam -->
  <section class="content" id="add-borrower-content" style="display: none;">
    <h1>Input Data Peminjam</h1>
    <div class="form-container">
      <form id="borrower-form">
        <div class="mb-3">
          <label for="name" class="form-label">Nama</label>
          <input type="text" class="form-control" id="name" placeholder="Nama peminjam" required>
        </div>
        <div class="mb-3">
          <label for="nim" class="form-label">NIM</label>
          <input type="text" class="form-control" id="nim" placeholder="NIM peminjam" required>
        </div>
        <div class="mb-3">
          <label for="prodi" class="form-label">Prodi</label>
          <input type="text" class="form-control" id="prodi" placeholder="Program Studi" required>
        </div>
        <div class="mb-3">
          <label for="book" class="form-label">Judul Buku</label>
          <input type="text" class="form-control" id="book" placeholder="Judul Buku yang Dipinjam" required>
        </div>
        <div class="mb-3">
          <label for="return-date" class="form-label">Tanggal Kembali</label>
          <input type="date" class="form-control" id="return-date" required>
        </div>
        <button type="submit" class="btn btn-primary">Simpan</button>
      </form>
    </div>
  </section>

  <!-- List Peminjaman -->
  <section class="content" id="borrowing-list-content" style="display: none;">
    <h1>List Peminjaman</h1>
    <div class="table-container">
        <table class="table table-striped" id="borrowing-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Nama</th>
                <th>NIM</th>
                <th>Prodi</th>
                <th>Judul Buku</th>
                <th>Tanggal Pinjam</th>
                <th>Denda</th>
                <th>Aksi</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Alice</td>
                <td>12345678</td>
                <td>Teknik Informatika</td>
                <td>Basis Data</td>
                <td>2024-12-10</td>
                <td>
                  <input type="number" class="form-control fine-input" placeholder="Rp" min="0" readonly>
                </td>
                <td>
                  <button class="btn btn-success btn-sm" onclick="verifyReturn(this, '2024-12-10')">Verifikasi</button>
                </td>
              </tr>
            </tbody>
          </table>              
    </div>
  </section>

  <script>
    function showBooks() {
      document.getElementById('books-content').style.display = 'block';
      document.getElementById('add-borrower-content').style.display = 'none';
      document.getElementById('borrowing-list-content').style.display = 'none';
    }

    function showAddBorrower() {
      document.getElementById('books-content').style.display = 'none';
      document.getElementById('add-borrower-content').style.display = 'block';
      document.getElementById('borrowing-list-content').style.display = 'none';
    }

    function showBorrowingList() {
      document.getElementById('books-content').style.display = 'none';
      document.getElementById('add-borrower-content').style.display = 'none';
      document.getElementById('borrowing-list-content').style.display = 'block';
    }

    function verifyReturn(button, returnDate) {
      const currentDate = new Date().toISOString().split('T')[0];
      const returnDateObj = new Date(returnDate);
      const currentDateObj = new Date(currentDate);

      let fine = 0;
      if (currentDateObj > returnDateObj) {
        const daysLate = Math.ceil((currentDateObj - returnDateObj) / (1000 * 60 * 60 * 24));
        fine = daysLate * 2000; // Contoh: Denda Rp 2000 per hari
      }

      if (confirm(`Verifikasi pengembalian?\nDenda: Rp ${fine}`)) {
        button.closest('tr').remove();
        alert('Pengembalian berhasil diverifikasi!');
      }
    }
    

    function verifyReturn(button, returnDate) {
  const fineInput = button.closest('tr').querySelector('.fine-input');
  const currentDate = new Date().toISOString().split('T')[0];
  const returnDateObj = new Date(returnDate);
  const currentDateObj = new Date(currentDate);

  let fine = 0;
  
  // Menghitung denda jika terlambat
  if (currentDateObj > returnDateObj) {
    const daysLate = Math.ceil((currentDateObj - returnDateObj) / (1000 * 60 * 60 * 24));
    fine = daysLate * 1000; // Denda Rp 1000 per hari keterlambatan
  }

  fineInput.value = fine > 0 ? `Rp ${fine}` : 'Rp 0'; // Menampilkan denda atau 0

  // Validasi input denda
  if (fine === 0) {
    alert("Buku sudah dikembalikan tepat waktu atau belum terlambat.");
    return;
  }

  // Konfirmasi verifikasi
  if (confirm(`Verifikasi pengembalian?\nDenda yang dihitung: ${fineInput.value}`)) {
    // Perbarui status baris dan denda
    const row = button.closest('tr');
    row.querySelector('td:nth-child(7)').innerText = fineInput.value; // Update kolom denda
    button.closest('td').innerHTML = "-"; // Ganti tombol dengan tanda "-"
    alert('Pengembalian berhasil diverifikasi!');
  }
}

  </script>

</body>
</html>
